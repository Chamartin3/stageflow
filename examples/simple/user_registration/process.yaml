# StageFlow Process Definition: User Registration
# A simple 3-stage process demonstrating basic StageFlow concepts

process:
  name: user_registration
  initial_stage: email_signup
  final_stage: active_user

  stages:
    email_signup:
      # User provides email and password during signup
      schema:
        required_fields:
          - email
          - password

      gates:
        email_verification:
          target_stage: profile_setup
          locks:
            - name: email_confirmed
              type: exists
              property: "meta.email_verified_at"
              description: "Email verification timestamp must exist"

    profile_setup:
      # User completes their profile with additional information
      schema:
        required_fields:
          - email
          - password
          - first_name
          - last_name
        optional_fields:
          - date_of_birth
          - phone_number

      gates:
        profile_completion:
          target_stage: active_user
          locks:
            - name: profile_complete
              type: exists
              property: "profile.required_fields"
              description: "Required profile fields must be completed"

            - name: terms_accepted
              type: equals
              property: "meta.terms_accepted"
              benchmark: true
              description: "User must accept terms and conditions"

    active_user:
      # Final stage - user is fully activated
      schema:
        required_fields:
          - email
          - password
          - first_name
          - last_name

  # Configuration options
  allow_stage_skipping: false
  regression_detection: true

  metadata:
    description: "Simple user registration process with email verification"
    version: "1.0.0"
    author: "StageFlow Examples"
    use_case: "user_onboarding"
    complexity: "simple"