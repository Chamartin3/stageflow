# Test data for simple_task_workflow process
# Contains various task scenarios to demonstrate workflow progression

test_cases:
  # Complete task that has gone through all stages
  - name: "completed_task"
    description: "Task that has been successfully completed"
    element:
      title: "Implement user authentication"
      description: "Add login/logout functionality to the application"
      priority: "high"
      due_date: "2024-02-15"
      labels: ["backend", "security"]
      assignee:
        user_id: "dev_001"
        name: "John Developer"
        email: "john.dev@company.com"
      status: "completed"
      progress_notes: "Implemented OAuth2 integration with JWT tokens"
      completion_percentage: 100
      meta:
        created_at: "2024-01-15T09:00:00Z"
        assigned_at: "2024-01-15T09:30:00Z"
        started_at: "2024-01-16T10:00:00Z"
        completed_at: "2024-01-18T16:30:00Z"
    expected_stage: "task_completed"
    expected_state: "completed"

  # New task that just got created
  - name: "new_unassigned_task"
    description: "Newly created task waiting for assignment"
    element:
      title: "Design user dashboard"
      description: "Create wireframes and mockups for the main user dashboard"
      priority: "medium"
      due_date: "2024-02-20"
      labels: ["frontend", "design"]
      meta:
        created_at: "2024-01-15T14:00:00Z"
    expected_stage: "task_created"
    expected_state: "awaiting"
    blocking_locks:
      - "assignee_set"

  # Task assigned but work not started
  - name: "assigned_not_started"
    description: "Task assigned to someone but work hasn't begun"
    element:
      title: "Write API documentation"
      description: "Document all REST API endpoints with examples"
      priority: "low"
      due_date: "2024-02-25"
      assignee:
        user_id: "tech_writer_001"
        name: "Sarah Writer"
        email: "sarah.writer@company.com"
      meta:
        created_at: "2024-01-15T11:00:00Z"
        assigned_at: "2024-01-15T11:30:00Z"
    expected_stage: "task_assigned"
    expected_state: "awaiting"
    blocking_locks:
      - "work_started"

  # Task in progress
  - name: "work_in_progress"
    description: "Task currently being worked on"
    element:
      title: "Optimize database queries"
      description: "Review and optimize slow-running database queries"
      priority: "high"
      assignee:
        user_id: "dba_001"
        name: "Mike Database"
        email: "mike.db@company.com"
      progress_notes: "Identified 5 slow queries, optimized 2 so far"
      completion_percentage: 40
      meta:
        created_at: "2024-01-14T08:00:00Z"
        assigned_at: "2024-01-14T08:15:00Z"
        started_at: "2024-01-14T09:00:00Z"
    expected_stage: "task_in_progress"
    expected_state: "fulfilling"
    blocking_locks:
      - "work_completed"
      - "completion_confirmed"

  # Task ready to be completed (work done but not marked complete)
  - name: "work_done_pending_completion"
    description: "Work is finished but task not formally completed"
    element:
      title: "Set up CI/CD pipeline"
      description: "Configure automated testing and deployment"
      priority: "urgent"
      assignee:
        user_id: "devops_001"
        name: "Alex DevOps"
        email: "alex.devops@company.com"
      progress_notes: "Pipeline configured, all tests passing"
      completion_percentage: 100
      meta:
        created_at: "2024-01-13T10:00:00Z"
        assigned_at: "2024-01-13T10:30:00Z"
        started_at: "2024-01-13T11:00:00Z"
        completed_at: "2024-01-15T17:00:00Z"
        # Missing status: "completed"
    expected_stage: "task_in_progress"
    expected_state: "awaiting"
    blocking_locks:
      - "completion_confirmed"

  # Invalid cases for testing
  - name: "invalid_priority"
    description: "Task with invalid priority value"
    element:
      title: "Test task"
      description: "This is a test task"
      priority: "super_urgent"  # Invalid priority
      meta:
        created_at: "2024-01-15T10:00:00Z"
    expected_stage: "task_created"
    expected_state: "scoping"
    validation_errors:
      - field: "priority"
        validator: "in_list"

  - name: "missing_required_fields"
    description: "Task missing required fields"
    element:
      # missing title and description
      priority: "medium"
      meta:
        created_at: "2024-01-15T10:00:00Z"
    expected_stage: "task_created"
    expected_state: "scoping"
    validation_errors:
      - field: "title"
        error: "required_field_missing"
      - field: "description"
        error: "required_field_missing"

  - name: "invalid_assignee"
    description: "Task assigned to non-existent user"
    element:
      title: "Invalid assignment test"
      description: "Test task with invalid assignee"
      priority: "low"
      assignee:
        user_id: "nonexistent_user"
        name: "Ghost User"
        email: "ghost@nowhere.com"
      meta:
        created_at: "2024-01-15T10:00:00Z"
        assigned_at: "2024-01-15T10:30:00Z"
    expected_stage: "task_assigned"
    expected_state: "scoping"
    validation_errors:
      - field: "assignee"
        validator: "user_exists"

expected_evaluation_results:
  # What each test case should produce when evaluated
  completed_task:
    current_stage: "task_completed"
    evaluation_state: "completed"
    can_advance: false
    can_regress: false
    actions: []
    completion_time: "2024-01-18T16:30:00Z"

  new_unassigned_task:
    current_stage: "task_created"
    evaluation_state: "awaiting"
    can_advance: false
    can_regress: false
    actions:
      - type: "assign_task"
        description: "Assign task to appropriate team member"
        priority: "normal"
    blocking_conditions:
      - lock: "assignee_set"
        reason: "Task must be assigned before work can begin"

  assigned_not_started:
    current_stage: "task_assigned"
    evaluation_state: "awaiting"
    can_advance: false
    can_regress: false
    actions:
      - type: "notify_assignee"
        description: "Notify assignee that task is ready to start"
        priority: "low"
    blocking_conditions:
      - lock: "work_started"
        reason: "Work has not been started on this task"

  work_in_progress:
    current_stage: "task_in_progress"
    evaluation_state: "fulfilling"
    can_advance: false
    can_regress: false
    actions:
      - type: "check_progress"
        description: "Check on task progress and provide support if needed"
        priority: "low"
    progress_indicators:
      - metric: "completion_percentage"
        value: 40
        target: 100

  work_done_pending_completion:
    current_stage: "task_in_progress"
    evaluation_state: "awaiting"
    can_advance: false
    can_regress: false
    actions:
      - type: "mark_complete"
        description: "Mark task as completed in the system"
        priority: "high"
    blocking_conditions:
      - lock: "completion_confirmed"
        reason: "Task status must be set to 'completed'"