# Case 1.7: Multiple Gates Process
# Tests: Content moderation process with multiple gates
# Expected: Process loads and demonstrates various gate types

process:
  name: multiple_gates
  description: "Content moderation process with multiple gates"
  initial_stage: submitted
  final_stage: published

  stages:
    submitted:
      gates:
        auto_approve:
          target_stage: published
          locks:
            - exists: "author.trusted_status"
            - type: equals
              property_path: "author.trusted_status"
              expected_value: true
            - type: less_than
              property_path: "content.word_count"
              expected_value: 500

        send_to_moderation:
          target_stage: moderation
          locks:
            - type: greater_than
              property_path: "content.word_count"
              expected_value: 500
            - exists: "flags.spam_detected"

    moderation:
      gates:
        approve:
          target_stage: senior_review
          locks:
            - type: equals
              property_path: "moderation.decision"
              expected_value: "approve"
            - exists: "moderation.reviewed_by"

        reject:
          target_stage: rejected
          locks:
            - type: equals
              property_path: "moderation.decision"
              expected_value: "reject"
            - exists: "moderation.rejection_reason"

        needs_revision:
          target_stage: revision
          locks:
            - type: equals
              property_path: "moderation.decision"
              expected_value: "revise"
            - exists: "moderation.revision_notes"

        escalate:
          target_stage: senior_review
          locks:
            - exists: "flags.escalation_requested"

    senior_review:
      gates:
        final_approve:
          target_stage: published
          locks:
            - type: equals
              property_path: "senior_review.decision"
              expected_value: "approve"

        final_reject:
          target_stage: rejected
          locks:
            - type: equals
              property_path: "senior_review.decision"
              expected_value: "reject"

    revision:
      gates:
        resubmit:
          target_stage: submitted
          locks:
            - exists: "content.revised_text"
            - exists: "revision.submitted_date"
            - type: equals
              property_path: "revision.abandoned"
              expected_value: false

    rejected:
      gates: []

    published:
      gates: []

  allow_stage_skipping: false
  regression_detection: true

  metadata:
    description: "Content moderation process with multiple gates"
    test_case: "consistency_multiple_gates"