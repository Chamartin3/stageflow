# Onboarding Stage - New hire preparation
name: "Onboarding"
description: "Pre-start onboarding including paperwork, equipment, and orientation scheduling"

fields:
  - onboarding.started_at
  - onboarding.coordinator_id
  - onboarding.background_check_status
  - onboarding.background_check_completed_at
  - onboarding.i9_completed
  - onboarding.tax_forms_completed
  - onboarding.direct_deposit_setup
  - onboarding.equipment_ordered
  - onboarding.equipment_shipped
  - onboarding.badge_created
  - onboarding.email_provisioned
  - onboarding.slack_added
  - onboarding.orientation_scheduled
  - onboarding.mentor_assigned
  - onboarding.first_day_agenda_sent
  - onboarding.status
  - onboarding.rejection_reason
  - candidate.withdrew

gates:
  onboarding_complete:
    target_stage: hired
    locks:
      - type: equals
        property_path: "onboarding.background_check_status"
        expected_value: "passed"
        error_message: "Background check must pass"
      - type: equals
        property_path: "onboarding.i9_completed"
        expected_value: true
        error_message: "I-9 form must be completed"
      - type: equals
        property_path: "onboarding.tax_forms_completed"
        expected_value: true
      - type: equals
        property_path: "onboarding.equipment_ordered"
        expected_value: true
      - type: equals
        property_path: "onboarding.email_provisioned"
        expected_value: true
      - exists: "onboarding.orientation_scheduled"

  background_check_failed:
    target_stage: rejected
    locks:
      - type: equals
        property_path: "onboarding.background_check_status"
        expected_value: "failed"
      - exists: "onboarding.rejection_reason"

  candidate_withdrew:
    target_stage: withdrawn
    locks:
      - type: equals
        property_path: "candidate.withdrew"
        expected_value: true
