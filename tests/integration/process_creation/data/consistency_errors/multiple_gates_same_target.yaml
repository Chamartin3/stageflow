# Case 1.5: Multiple Gates Targeting Same Stage
# Tests: Process where multiple gates target the same stage (consistency error)
# Expected: Consistency check should detect multiple gates to same target

process:
  name: multiple_gates_same_target
  description: Process with multiple gates targeting the same stage (consistency error)
  initial_stage: draft
  final_stage: published

  stages:
    draft:
      gates:
        ready_for_review:
          target_stage: review
          locks:
            - exists: "title"
            - type: "not_empty"
              property_path: "title"

    review:
      gates:
        # CONSISTENCY ERROR: Both gates target the same stage 'published'
        standard_approval:
          target_stage: published  # ← Same target
          locks:
            - type: "equals"
              property_path: "review_status"
              expected_value: "approved"
            - exists: "approved_at"

        fast_track_approval:
          target_stage: published  # ← Same target (ERROR!)
          locks:
            - type: "equals"
              property_path: "priority"
              expected_value: "urgent"
            - exists: "fast_track_approved_by"

    published:
      gates: []  # Final stage

  allow_stage_skipping: false
  regression_detection: true

  metadata:
    description: "Process with multiple gates targeting same stage"
    test_case: "consistency_multiple_gates_same_target"