# StageFlow Process Definition: Simple Task Workflow
# A basic 4-stage task management process demonstrating StageFlow concepts

process:
  name: simple_task_workflow
  initial_stage: task_created
  final_stage: task_completed

  stages:
    task_created:
      # Initial task creation with basic information
      schema:
        name: task_created_schema
        required_fields:
          - title
          - description
          - priority
        optional_fields:
          - due_date
          - labels

      gates:
        task_assignment:
          target_stage: task_assigned
          locks:
            - name: assignee_set
              type: exists
              property: "assignee.user_id"
              description: "Task must be assigned to a user"

    task_assigned:
      # Task has been assigned to someone
      schema:
        name: task_assigned_schema
        required_fields:
          - title
          - description
          - priority
          - assignee

      gates:
        start_work:
          target_stage: task_in_progress
          locks:
            - name: work_started
              type: exists
              property: "meta.started_at"
              description: "Work start timestamp must be recorded"

    task_in_progress:
      # Task is actively being worked on
      schema:
        name: task_in_progress_schema
        required_fields:
          - title
          - description
          - priority
          - assignee
        optional_fields:
          - progress_notes
          - completion_percentage

      gates:
        mark_complete:
          target_stage: task_completed
          locks:
            - name: work_completed
              type: exists
              property: "meta.completed_at"
              description: "Work completion timestamp must be recorded"

            - name: completion_confirmed
              type: equals
              property: "status"
              benchmark: "completed"
              description: "Task status must be marked as completed"

    task_completed:
      # Final stage - task is done
      schema:
        name: task_completed_schema
        required_fields:
          - title
          - description
          - priority
          - assignee
          - status

  # Configuration options
  allow_stage_skipping: false
  regression_detection: true

  metadata:
    description: "Simple task workflow from creation to completion"
    version: "1.0.0"
    author: "StageFlow Examples"
    use_case: "task_management"
    complexity: "simple"