# Case 3.1: Branching Process Flow
# Tests: Simple branching process visualization

process:
  name: branching_approval_process
  initial_stage: submitted
  final_stage: completed

  stages:
    submitted:
      schema:
        required_fields:
          - request_id
          - request_type
          - requestor

      gates:
        auto_approve_simple:
          target_stage: completed
          locks:
            - type: EQUALS
              property_path: "request_type"
              expected_value: "simple"
            - type: EQUALS
              property_path: "requestor.auto_approve_eligible"
              expected_value: true

        manual_review_required:
          target_stage: manual_review
          locks:
            - type: IN_LIST
              property_path: "request_type"
              expected_value: ["complex", "sensitive", "high_value"]

        standard_approval:
          target_stage: standard_review
          locks:
            - type: EQUALS
              property_path: "request_type"
              expected_value: "standard"

    manual_review:
      schema:
        required_fields:
          - request_id
          - assigned_reviewer
          - review_priority

      gates:
        approve_request:
          target_stage: completed
          locks:
            - type: EQUALS
              property_path: "review.decision"
              expected_value: "approved"

        reject_request:
          target_stage: rejected
          locks:
            - type: EQUALS
              property_path: "review.decision"
              expected_value: "rejected"

    standard_review:
      schema:
        required_fields:
          - request_id
          - standard_checks_completed

      gates:
        pass_standard_checks:
          target_stage: completed
          locks:
            - type: EQUALS
              property_path: "standard_checks_completed"
              expected_value: true

        fail_standard_checks:
          target_stage: rejected
          locks:
            - type: EQUALS
              property_path: "standard_checks_completed"
              expected_value: false

    completed:
      schema:
        required_fields:
          - request_id
          - completion_date
          - approval_method

    rejected:
      schema:
        required_fields:
          - request_id
          - rejection_date
          - rejection_reason

  allow_stage_skipping: false
  regression_detection: true

  metadata:
    description: "Simple branching approval process for visualization testing"
    version: "1.0.0"
    test_case: "visualization_branching_flow"
    visualization_notes: "Should show decision points with multiple paths leading to different outcomes"